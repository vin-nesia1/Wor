<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3PYZXZFNER"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-3PYZXZFNER');
    </script>

    <title>Penghitung Kata Online Gratis: DOCX, PDF, TXT, ZIP | Word.Vinnesia.my.id</title>
    <meta name="description" content="Penghitung kata online instan untuk DOCX, PDF, TXT, & ZIP. Hitung kata, karakter (dengan/tanpa spasi), kalimat, paragraf, serta estimasi waktu baca & bicara cepat.">
    <meta name="keywords" content="penghitung kata online, word counter, hitung kata, hitung karakter, hitung kalimat, hitung paragraf, waktu baca, waktu bicara, upload file, hitung DOCX, hitung PDF, hitung TXT, hitung ZIP, alat gratis, Vinnesia, Vinnesia Word Counter">
    <meta name="author" content="Vinnesia">
    <link rel="canonical" href="https://word.vinnesia.my.id">
    <meta name="robots" content="index, follow">

    <meta property="og:title" content="Penghitung Kata Online Gratis: DOCX, PDF, TXT, ZIP | Word.Vinnesia.my.id">
    <meta property="og:description" content="Penghitung kata online instan untuk DOCX, PDF, TXT, & ZIP. Hitung kata, karakter (dengan/tanpa spasi), kalimat, paragraf, serta estimasi waktu baca & bicara cepat.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://word.vinnesia.my.id">
    <meta property="og:image" content="https://word.vinnesia.my.id/logo.png">
    <meta property="og:image:alt" content="Logo Vinnesia Word Counter">
    <meta property="og:site_name" content="Vinnesia Word Counter">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Penghitung Kata Online Gratis: DOCX, PDF, TXT, ZIP | Word.Vinnesia.my.id">
    <meta name="twitter:description" content="Penghitung kata online instan untuk DOCX, PDF, TXT, & ZIP. Hitung kata, karakter (dengan/tanpa spasi), kalimat, paragraf, serta estimasi waktu baca & bicara cepat.">
    <meta name="twitter:image" content="https://word.vinnesia.my.id/logo.png">
    <meta name="twitter:image:alt" content="Logo Vinnesia Word Counter">

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

    <style>
        :root {
            --primary-color: #5C2D91; /* Ungu gelap Vinnesia */
            --secondary-color: #2D5C40; /* Hijau kehitaman Vinnesia */
            --text-color: #FFFFFF; /* Putih */
            --light-purple: #7B4BA6; /* Ungu sedang */
            --dark-green: #1F3F2D; /* Hijau gelap */
            --bg-start-color: #2D5C40; /* Hijau kehitaman */
            --bg-end-color: #5C2D91; /* Ungu gelap */

            --card-background: rgba(0, 0, 0, 0.6); /* Sedikit transparan agar background terlihat */
            --border-color: #666;
            --button-hover-primary: #7B4BA6;
            --button-hover-secondary: #3A7A50;
            --error-color: #FF5C5C;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-start-color), var(--bg-end-color)); /* Gradient diagonal */
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden; /* Mencegah scroll horizontal */
        }

        /* Overlay untuk memberikan tekstur/kedalaman */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top left, rgba(255,255,255,0.05), transparent 60%),
                        radial-gradient(circle at bottom right, rgba(0,0,0,0.1), transparent 60%);
            pointer-events: none; /* Agar tidak mengganggu interaksi */
            z-index: 1;
        }

        header, footer {
            background-color: var(--primary-color); /* Ungu solid */
            color: white;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        header .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        header img {
            height: 50px;
            margin-bottom: 10px;
        }

        header h1 {
            font-size: 2.2em;
            margin-bottom: 5px;
        }

        header p {
            font-size: 1.1em;
            margin-bottom: 15px;
        }

        header a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 15px;
            border: 1px solid white;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        header a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        main {
            flex: 1;
            padding: 2rem 0;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 20px;
            z-index: 5;
            position: relative;
        }

        .counter-section {
            background-color: var(--card-background);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .upload-area:hover {
            background-color: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-color);
        }

        .upload-area.dragover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: var(--light-purple);
        }

        .upload-area p {
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .upload-area button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .upload-area button:hover {
            background-color: var(--button-hover-primary);
        }

        #fileNameDisplay {
            margin-top: 10px;
            font-style: italic;
            color: #C0C0C0;
            font-size: 0.9em;
        }

        #fileError {
            color: var(--error-color);
            margin-top: 10px;
            font-weight: bold;
            display: none; /* Sembunyikan secara default */
        }

        textarea {
            width: 100%;
            min-height: 250px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.4);
            color: var(--text-color);
            font-size: 1.1em;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(92, 45, 145, 0.5);
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .button-group button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            flex-grow: 1;
            max-width: 180px;
        }

        .button-group button:hover {
            background-color: var(--button-hover-secondary);
            transform: translateY(-2px);
        }

        .button-group button:active {
            transform: translateY(0);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .result-item {
            background-color: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .result-item h3 {
            font-size: 1.1em;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .result-item p {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--text-color);
            margin: 0;
        }

        footer {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 1.5rem 0;
            margin-top: auto;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        footer .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        footer p {
            margin: 0;
            font-size: 0.9em;
        }

        footer a {
            color: white;
            text-decoration: underline;
            margin: 0 5px;
            transition: color 0.3s ease;
        }

        footer a:hover {
            color: #D1BDE9;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            header p {
                font-size: 1em;
            }

            .counter-section {
                padding: 20px;
            }

            .button-group {
                flex-direction: column;
                align-items: stretch;
            }

            .button-group button {
                max-width: 100%;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            body {
                background: linear-gradient(135deg, var(--bg-start-color), var(--bg-end-color));
            }
        }

        @media (max-width: 480px) {
            header img {
                height: 40px;
            }

            header h1 {
                font-size: 1.5em;
            }

            main {
                padding: 10px;
            }

            textarea {
                min-height: 200px;
                font-size: 1em;
            }

            .button-group button {
                padding: 10px 15px;
                font-size: 0.9em;
            }

            .result-item h3 {
                font-size: 1em;
            }

            .result-item p {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <a href="https://www.vinnesia.my.id">
                <img src="/logo.png" alt="Logo Vinnesia">
            </a>
            <h1>Penghitung Kata Online</h1>
            <p>Hitung kata, karakter, kalimat, paragraf, dan estimasi waktu baca/bicara Anda!</p>
            <a href="https://www.vinnesia.my.id">Kembali ke Homepage</a>
        </div>
    </header>

    <main>
        <section class="counter-section">
            <div id="uploadArea" class="upload-area">
                <input type="file" id="fileInput" accept=".txt,.docx,.pdf,.zip" style="display: none;">
                <p>Seret & Jatuhkan file di sini atau</p>
                <button id="uploadBtn">Pilih File</button>
                <div id="fileNameDisplay"></div>
                <div id="fileError" style="color: var(--error-color); margin-top: 10px; display: none;"></div>
            </div>

            <textarea id="textInput" placeholder="Ketik atau tempel teks Anda di sini..."></textarea>

            <div class="button-group">
                <button id="pasteBtn">Tempel</button>
                <button id="clearBtn">Bersihkan</button>
                <button id="copyBtn">Salin Hasil</button>
            </div>

            <div class="results-grid">
                <div class="result-item">
                    <h3>Jumlah Kata</h3>
                    <p id="wordCount">0</p>
                </div>
                <div class="result-item">
                    <h3>Karakter (dengan spasi)</h3>
                    <p id="charCountWithSpaces">0</p>
                </div>
                <div class="result-item">
                    <h3>Karakter (tanpa spasi)</h3>
                    <p id="charCountNoSpaces">0</p>
                </div>
                <div class="result-item">
                    <h3>Jumlah Kalimat</h3>
                    <p id="sentenceCount">0</p>
                </div>
                <div class="result-item">
                    <h3>Jumlah Paragraf</h3>
                    <p id="paragraphCount">0</p>
                </div>
                <div class="result-item">
                    <h3>Waktu Baca (menit)</h3>
                    <p id="readingTime">0</p>
                </div>
                <div class="result-item">
                    <h3>Waktu Bicara (menit)</h3>
                    <p id="speakingTime">0</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; <span id="currentYear"></span> Vinnesia.my.id. Semua Hak Dilindungi.</p>
            <p>
                <a href="https://www.vinnesia.my.id/privacy">Kebijakan Privasi</a>
            </p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth.js/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.min.mjs" type="module"></script>
    <script>
        // Set workerSrc for pdf.js. Note: This block needs to be after the pdf.min.mjs import.
        // The check `typeof pdfjsLib !== 'undefined'` is a safeguard, but standard practice is to set it directly.
        // For optimal loading, ensure pdf.min.mjs is loaded before trying to set GlobalWorkerOptions.
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.worker.min.mjs';
        } else {
            // Fallback for environments where pdfjsLib might not be immediately available globally
            // (e.g., if loaded as a true module and not exposed globally).
            // A more robust solution for module contexts would be to set this *within* the import chain.
            // For this single-file HTML, this setup is typically sufficient if the script order is correct.
            console.warn("pdfjsLib is not defined. GlobalWorkerOptions might not be set for PDF.js.");
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textInput = document.getElementById('textInput');
            const wordCount = document.getElementById('wordCount');
            const charCountWithSpaces = document.getElementById('charCountWithSpaces');
            const charCountNoSpaces = document.getElementById('charCountNoSpaces');
            const sentenceCount = document.getElementById('sentenceCount');
            const paragraphCount = document.getElementById('paragraphCount');
            const readingTime = document.getElementById('readingTime');
            const speakingTime = document.getElementById('speakingTime');
            const pasteBtn = document.getElementById('pasteBtn');
            const clearBtn = document.getElementById('clearBtn');
            const copyBtn = document.getElementById('copyBtn');
            const currentYear = document.getElementById('currentYear');

            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const uploadBtn = document.getElementById('uploadBtn');
            const fileNameDisplay = document.getElementById('fileNameDisplay');
            const fileError = document.getElementById('fileError');

            // Set current year in footer
            currentYear.textContent = new Date().getFullYear();

            // --- Core Counting Logic ---
            function updateCounts() {
                const text = textInput.value;

                // Word Count
                const words = text.match(/\b\w+\b/g);
                const numWords = words ? words.length : 0;
                wordCount.textContent = numWords;

                // Character Count (with spaces)
                charCountWithSpaces.textContent = text.length;

                // Character Count (no spaces)
                charCountNoSpaces.textContent = text.replace(/\s/g, '').length;

                // Sentence Count
                const sentences = text.split(/[.!?]+/).filter(s => s.trim() !== '');
                sentenceCount.textContent = sentences.length;

                // Paragraph Count
                const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim() !== '');
                paragraphCount.textContent = paragraphs.length;

                // Reading Time (average 200 words per minute)
                const readingMinutes = numWords > 0 ? Math.ceil(numWords / 200) : 0;
                readingTime.textContent = readingMinutes;

                // Speaking Time (average 130 words per minute)
                const speakingMinutes = numWords > 0 ? Math.ceil(numWords / 130) : 0;
                speakingTime.textContent = speakingMinutes;
            }

            // Real-time update on input
            textInput.addEventListener('input', updateCounts);

            // --- Button Functionality ---
            pasteBtn.addEventListener('click', async () => {
                try {
                    const text = await navigator.clipboard.readText();
                    textInput.value = text;
                    updateCounts();
                    fileNameDisplay.textContent = ''; // Clear file name on paste
                    fileError.style.display = 'none';
                } catch (err) {
                    alert('Gagal menempel teks. Pastikan Anda memberikan izin akses clipboard.');
                }
            });

            clearBtn.addEventListener('click', () => {
                textInput.value = '';
                updateCounts();
                fileNameDisplay.textContent = ''; // Clear file name on clear
                fileError.style.display = 'none';
            });

            copyBtn.addEventListener('click', async () => {
                const resultsText = `
Hasil Penghitung Kata:
----------------------
Jumlah Kata: ${wordCount.textContent}
Karakter (dengan spasi): ${charCountWithSpaces.textContent}
Karakter (tanpa spasi): ${charCountNoSpaces.textContent}
Jumlah Kalimat: ${sentenceCount.textContent}
Jumlah Paragraf: ${paragraphCount.textContent}
Estimasi Waktu Baca: ${readingTime.textContent} menit
Estimasi Waktu Bicara: ${speakingTime.textContent} menit
                `.trim();

                try {
                    await navigator.clipboard.writeText(resultsText);
                    alert('Hasil berhasil disalin ke clipboard!');
                } catch (err) {
                    alert('Gagal menyalin hasil. Pastikan Anda memberikan izin akses clipboard.');
                }
            });

            // --- File Upload Logic ---
            uploadBtn.addEventListener('click', () => {
                fileInput.click(); // Trigger file input click
            });

            fileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    processFile(file);
                }
                event.target.value = ''; // Clear the input so same file can be uploaded again
            });

            // Drag & Drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file) {
                    processFile(file);
                }
            });

            async function processFile(file) {
                fileNameDisplay.textContent = `Memproses: ${file.name} (${(file.size / 1024).toFixed(2)} KB)...`;
                fileError.style.display = 'none';
                textInput.value = 'Memuat dan menganalisis file... Mohon tunggu.';
                updateCounts(); // Update counts to show loading state

                const fileExtension = file.name.split('.').pop().toLowerCase();
                let extractedText = '';

                try {
                    const arrayBuffer = await file.arrayBuffer();

                    if (fileExtension === 'txt') {
                        const decoder = new TextDecoder('utf-8');
                        extractedText = decoder.decode(arrayBuffer);
                    } else if (fileExtension === 'docx') {
                        const result = await mammoth.extractRawText({ arrayBuffer: arrayBuffer });
                        extractedText = result.value; // The raw text
                    } else if (fileExtension === 'pdf') {
                        // Dynamically import pdfjsLib if it's not globally available.
                        // This block should only execute if pdfjsLib wasn't loaded by the <script type="module"> tag.
                        // However, for CDN with `type="module"`, it's generally exposed globally.
                        const pdfjsLibModule = typeof window.pdfjsLib !== 'undefined' ? window.pdfjsLib : await import('https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.min.mjs');
                        if (pdfjsLibModule && typeof pdfjsLibModule.GlobalWorkerOptions !== 'undefined') {
                             // Ensure workerSrc is set, as it's crucial for PDF.js to function.
                             pdfjsLibModule.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.4.168/pdf.worker.min.mjs';
                        } else {
                            throw new Error("PDF.js library or worker options failed to load. Check console for details.");
                        }

                        const loadingTask = pdfjsLibModule.getDocument({ data: arrayBuffer });
                        const pdf = await loadingTask.promise;
                        let fullText = '';
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            fullText += textContent.items.map(item => item.str).join(' ') + '\n';
                        }
                        extractedText = fullText;
                    } else if (fileExtension === 'zip') {
                        const zip = await JSZip.loadAsync(arrayBuffer);
                        let combinedText = [];
                        const validTextExtensions = ['.txt', '.md', '.csv']; // Only process these extensions

                        for (const fileName in zip.files) {
                            const file = zip.files[fileName];
                            const fileExt = `.${fileName.split('.').pop().toLowerCase()}`;
                            if (!file.dir && validTextExtensions.includes(fileExt)) {
                                const fileContent = await file.async('text');
                                combinedText.push(fileContent);
                            }
                        }
                        extractedText = combinedText.join('\n\n'); // Join with double newline for paragraph separation
                    } else {
                        throw new Error('Jenis file tidak didukung. Mohon unggah .txt, .docx, .pdf, atau .zip.');
                    }

                    textInput.value = extractedText;
                    fileNameDisplay.textContent = `File diunggah: ${file.name}`;
                    updateCounts();

                } catch (error) {
                    console.error('Error processing file:', error);
                    fileError.textContent = `Error: ${error.message}`;
                    fileError.style.display = 'block';
                    textInput.value = ''; // Clear textarea on error
                    fileNameDisplay.textContent = '';
                    updateCounts(); // Reset counts
                }
            }

            // Initial update on page load
            updateCounts();
        });
    </script>
</body>
</html>
